<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil de Datos - Ejecutiva Ambiental</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: Arial, sans-serif; background:#f5f5f5; padding:20px; font-size:12px; }
    .main-container { max-width:1200px; margin:0 auto; background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,.1); overflow:hidden; }

    .header { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:#fff; padding:25px 30px; display:flex; justify-content:space-between; align-items:center; }
    .logo-section { display:flex; align-items:center; gap:15px; }
    .logo { width:50px; height:50px; background:#fff; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#1e5a3e; font-weight:bold; font-size:20px; }
    .company-info h1 { margin:0; font-size:18px; font-weight:bold; }
    .company-info p { margin:3px 0 0 0; font-size:10px; opacity:.95; max-width:500px; }
    .document-info h2 { margin:0; font-size:22px; font-weight:bold; text-align:right; }
    .document-info p { margin:3px 0 0 0; font-size:11px; opacity:.9; text-align:right; }

    .form-content { padding:30px 40px; }
    .section { border-bottom:1px solid #e0e0e0; margin-bottom:30px; padding-bottom:25px; }
    .section:last-child { border-bottom:none; }
    .section-header { background:#1e5a3e; color:#fff; padding:10px 20px; margin:0 -40px 25px -40px; font-weight:bold; font-size:12px; text-transform:uppercase; letter-spacing:.5px; }

    .form-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px; }
    .form-group { display:flex; flex-direction:column; }
    .form-group.full-width { grid-column: 1 / -1; }

    label { font-weight:bold; color:#333; margin-bottom:6px; font-size:11px; text-transform:uppercase; }
    label .required { color:#dc3545; margin-left:3px; }
    label .optional { color:#6c757d; font-weight:normal; text-transform:none; margin-left:5px; font-size:10px; }

    input[type="text"], input[type="email"], input[type="tel"], input[type="number"],
    textarea, select, input[type="file"] {
      border:1px solid #ccc; padding:8px 10px; font-size:11px; border-radius:3px;
      background:#f9f9f9; font-family:inherit; transition:all .2s;
    }
    input:focus, textarea:focus, select:focus { outline:none; border-color:#1e5a3e; background:#fff; box-shadow:0 0 0 2px rgba(30,90,62,.1); }
    textarea { resize:vertical; min-height:80px; font-family: Arial, sans-serif; }
    input[type="file"] { padding:6px 8px; cursor:pointer; font-size:10px; }
    .helper-text { font-size:10px; color:#666; margin-top:4px; font-style:italic; }

    .file-preview { margin-top:8px; padding:8px 12px; background:#e8f5e9; border-left:3px solid #4caf50; border-radius:3px; font-size:11px; display:none; }
    .file-preview.active { display:block; }
    .file-preview-content { display:flex; align-items:center; justify-content:space-between; }
    .file-info { display:flex; align-items:center; gap:8px; }
    .file-icon { font-size:16px; }
    .file-name { font-weight:600; color:#2e7d32; }
    .file-size { color:#666; font-size:10px; }
    .file-remove { background:#dc3545; color:white; border:none; padding:4px 10px; border-radius:3px; cursor:pointer; font-size:10px; transition:background .2s; }
    .file-remove:hover { background:#c82333; }

    .radio-group { display:flex; gap:20px; margin-top:10px; }
    .radio-option { display:flex; align-items:center; gap:8px; cursor:pointer; }
    .radio-option input[type="radio"] { width:18px; height:18px; cursor:pointer; }
    .radio-option label { margin:0; cursor:pointer; text-transform:none; font-weight:normal; }

    .conditional-section { display:none; margin-top:20px; padding:20px; background:#fff3cd; border-left:4px solid #ffc107; border-radius:5px; }
    .conditional-section.active { display:block; }
    .conditional-header { font-weight:bold; color:#856404; margin-bottom:15px; font-size:12px; }

    .submit-section { margin-top:40px; padding-top:30px; border-top:2px solid #e0e0e0; text-align:center; }
    .btn-submit { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; padding:15px 50px; font-size:14px; font-weight:600; border:none; border-radius:5px; cursor:pointer; transition: all .3s ease; box-shadow:0 4px 15px rgba(30,90,62,.3); text-transform:uppercase; letter-spacing:.5px; }
    .btn-submit:hover { transform: translateY(-2px); box-shadow:0 6px 20px rgba(30,90,62,.4); }
    .btn-submit:disabled { opacity:.6; cursor:not-allowed; transform:none; }

    .message { padding:15px 20px; border-radius:5px; margin-top:20px; display:none; text-align:left; font-weight:500; font-size:13px; line-height:1.8; }
    .success-message { background:#d4edda; color:#155724; border:1px solid #c3e6cb; }
    .error-message { background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }

    .loading { display:none; text-align:center; margin-top:20px; }
    .loading-spinner { border:3px solid #f3f3f3; border-top:3px solid #1e5a3e; border-radius:50%; width:40px; height:40px; animation: spin 1s linear infinite; margin:0 auto; }
    @keyframes spin { 0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)} }
    .loading-text { margin-top:15px; color:#1e5a3e; font-weight:500; }

    .floating-buttons { position:fixed; bottom:30px; right:30px; display:flex; flex-direction:column; gap:15px; z-index:1000; }
    .floating-btn { width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none; font-size:28px; box-shadow:0 4px 15px rgba(0,0,0,.3); transition:all .3s ease; cursor:pointer; }
    .floating-btn:hover { transform: translateY(-5px); box-shadow:0 6px 20px rgba(0,0,0,.4); }
    .floating-btn.phone { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; }
    .floating-btn.whatsapp { background:#25D366; color:white; }
    .floating-btn-tooltip { position:absolute; right:75px; background:rgba(0,0,0,.8); color:white; padding:8px 15px; border-radius:5px; white-space:nowrap; font-size:13px; opacity:0; pointer-events:none; transition:opacity .3s; }
    .floating-btn:hover .floating-btn-tooltip { opacity:1; }

    .modal-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.8); z-index:9999; justify-content:center; align-items:center; overflow-y:auto; padding:20px; }
    .modal-overlay.active { display:flex; }
    .modal-content { background:white; border-radius:10px; max-width:800px; width:100%; max-height:90vh; overflow-y:auto; box-shadow:0 10px 40px rgba(0,0,0,.3); }
    .modal-header { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; padding:20px 30px; border-radius:10px 10px 0 0; }
    .modal-header h2 { margin:0; font-size:20px; }
    .modal-body { padding:30px; }
    .confirmation-section { margin-bottom:25px; padding-bottom:20px; border-bottom:1px solid #e0e0e0; }
    .confirmation-section:last-child { border-bottom:none; }
    .confirmation-section h3 { color:#1e5a3e; font-size:14px; margin-bottom:15px; display:flex; align-items:center; gap:10px; }
    .confirmation-item { display:flex; justify-content:space-between; padding:8px 0; font-size:12px; }
    .confirmation-label { font-weight:bold; color:#666; }
    .confirmation-value { color:#333; text-align:right; max-width:60%; }
    .file-list { list-style:none; padding:0; }
    .file-list li { padding:8px 12px; background:#f0f9f4; margin-bottom:5px; border-radius:3px; font-size:11px; display:flex; align-items:center; gap:8px; }
    .warning-box { background:#fff3cd; border-left:4px solid #ffc107; padding:15px; border-radius:5px; margin-top:20px; }
    .warning-box p { margin:0; color:#856404; font-size:12px; line-height:1.6; }
    .modal-buttons { display:flex; gap:15px; justify-content:center; margin-top:30px; }
    .btn-modal { padding:12px 30px; border:none; border-radius:5px; font-size:13px; font-weight:600; cursor:pointer; transition:all .3s; }
    .btn-confirm { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; }
    .btn-cancel { background:#6c757d; color:white; }

    @media (max-width:768px){
      body{padding:10px;}
      .form-grid{grid-template-columns:1fr;}
      .form-content{padding:20px;}
      .section-header{margin:0 -20px 20px -20px;}
      .header{flex-direction:column; gap:15px; text-align:center;}
      .document-info h2,.document-info p{ text-align:center; }
      .floating-buttons{bottom:20px; right:20px; gap:12px;}
      .floating-btn{width:55px; height:55px; font-size:24px;}
      .floating-btn-tooltip{display:none;}
      .modal-body{padding:20px;}
      .modal-buttons{flex-direction:column;}
    }

    .file-upload-group { border:2px dashed #ccc; border-radius:5px; padding:15px; background:#fafafa; transition:all .3s; }
    .file-upload-group:hover { border-color:#1e5a3e; background:#f0f9f4; }
    .file-upload-group.has-file { border-color:#4caf50; background:#e8f5e9; }
    .file-upload-group label { margin-bottom:8px; }
  </style>
</head>

<body>
  <div id="welcomeModal" class="modal-overlay">
    <div style="background: white; border-radius: 10px; max-width: 600px; width: 90%; padding: 40px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
      <div style="width: 80px; height: 80px; background: #1e5a3e; border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; color: white; font-size: 40px; font-weight: bold;">EA</div>
      <h2 style="color: #1e5a3e; margin: 0 0 20px 0; font-size: 24px;">隆Bienvenido!</h2>
      <p style="color: #333; font-size: 16px; line-height: 1.6; margin-bottom: 15px;"><strong>ESTIMADO CLIENTE,</strong></p>
      <p style="color: #666; font-size: 15px; line-height: 1.8; margin-bottom: 20px;">
        Hemos creado esta plataforma para mejorar su experiencia con nosotros. Es por ello que le agradecemos enormemente su confianza.
      </p>
      <div style="background: #f0f9f4; border-left: 4px solid #1e5a3e; padding: 20px; margin: 25px 0; border-radius: 5px;">
        <p style="color: #1e5a3e; font-size: 14px; margin: 0; font-weight: 500;">
          <strong>驴Tiene alguna duda?</strong><br>
          <span style="color: #666; font-weight: normal;">Por favor, no dude en comunicarse con nosotros:</span>
        </p>
      </div>
      <div style="display: flex; gap: 15px; justify-content: center; margin: 30px 0;">
        <a href="tel:2229417295" style="flex: 1; background: #1e5a3e; color: white; padding: 15px 20px; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; display:flex; align-items:center; justify-content:center; gap:8px;">
          <span style="font-size: 20px;"></span> Llamar Ahora
        </a>
        <a href="https://wa.me/522791113533" target="_blank" style="flex: 1; background: #25D366; color: white; padding: 15px 20px; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; display:flex; align-items:center; justify-content:center; gap:8px;">
          <span style="font-size: 20px;"></span> WhatsApp
        </a>
      </div>
      <button onclick="closeWelcomeModal()" style="background: #6c757d; color: white; border: none; padding: 12px 40px; border-radius: 5px; font-size: 15px; font-weight: 600; cursor: pointer;">
        Continuar al Formulario
      </button>
    </div>
  </div>

  <div id="confirmationModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header"><h2>锔 Verificar Informaci贸n Antes de Enviar</h2></div>
      <div class="modal-body" id="confirmationContent"></div>
    </div>
  </div>

  <div class="main-container">
    <div class="header">
      <div class="logo-section">
        <div class="logo">EA</div>
        <div class="company-info">
          <h1>EJECUTIVA AMBIENTAL</h1>
          <p>SEGURIDAD E HIGIENE, CAPACITACIN, MANTENIMIENTO INDUSTRIAL, PROTECCIN CIVIL, MEDIO AMBIENTE</p>
        </div>
      </div>
      <div class="document-info">
        <h2>PERFIL DE DATOS</h2>
        <p>Informaci贸n del Cliente</p>
      </div>
    </div>

    <div class="form-content">
      <form id="perfilDatosForm">
        <div class="section">
          <div class="section-header">Informaci贸n General</div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Nombre y puesto solicitante<span class="required">*</span></label>
              <input type="text" name="nombre_solicitante" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Denominaci贸n/Raz贸n social<span class="required">*</span></label>
              <input type="text" name="razon_social" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label>RFC<span class="required">*</span></label>
              <input type="text" name="rfc" required maxlength="13" style="text-transform: uppercase;">
            </div>
            <div class="form-group">
              <label>Tel茅fono empresa<span class="required">*</span></label>
              <input type="tel" name="telefono_empresa" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Representante legal<span class="required">*</span></label>
              <input type="text" name="representante_legal" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Direcci贸n donde se evaluar谩<span class="required">*</span></label>
              <input type="text" name="direccion_evaluacion" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label>Responsable de atendernos<span class="required">*</span></label>
              <input type="text" name="responsable" required>
            </div>
            <div class="form-group">
              <label>Tel茅fono<span class="required">*</span></label>
              <input type="tel" name="telefono_responsable" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Giro de la empresa<span class="required">*</span></label>
              <input type="text" name="giro" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Actividad principal</label>
              <input type="text" name="actividad_principal">
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label>Registro patronal</label>
              <input type="text" name="registro_patronal">
            </div>
            <div class="form-group">
              <label>Capacidad instalada</label>
              <input type="text" name="capacidad_instalada">
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Capacidad de operaci贸n</label>
              <input type="text" name="capacidad_operacion">
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>D铆as, turnos y horarios de trabajo<span class="required">*</span></label>
              <textarea name="dias_turnos_horarios" required placeholder="Ej: Lunes a Viernes, 2 turnos (8:00-16:00 y 16:00-00:00)"></textarea>
              <span class="helper-text">Especifique los d铆as de la semana, n煤mero de turnos y horarios</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Sobre el Informe de Resultados</div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Nombre de a qui茅n se dirige<span class="required">*</span></label>
              <input type="text" name="nombre_dirigido" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Puesto de a qui茅n se dirige<span class="required">*</span></label>
              <input type="text" name="puesto_dirigido" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Correo electr贸nico para enviar el informe digital<span class="required">*</span></label>
              <input type="email" name="correo_informe" required>
              <span class="helper-text">锔 Verifique que el correo sea correcto - aqu铆 recibir谩 su informe</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Coordinaci贸n de Evaluaci贸n</div>
          <div class="form-grid">
            <div class="form-group full-width">
              <label>Fechas preferidas para evaluaci贸n en sitio<span class="optional">(Para pre-calificar)</span></label>
              <textarea name="fechas_preferidas" placeholder="Ej: Preferimos la primera semana de febrero o tercera semana de marzo" rows="3"></textarea>
              <span class="helper-text">Esto nos ayuda a coordinar mejor la visita. Indique rangos de fechas o semanas de preferencia</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Descripci贸n del Proceso</div>
          <div class="form-grid">
            <div class="form-group full-width">
              <label>Breve descripci贸n del proceso operativo o productivo</label>
              <textarea name="descripcion_proceso" placeholder="Describa brevemente el proceso operativo de su empresa..."></textarea>
              <span class="helper-text">Tambi茅n puede adjuntar documento m谩s adelante</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Archivos Adjuntos</div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="planos">
              <label>1) Planos generales - Layout de la empresa<span class="required">*</span></label>
              <input type="file" name="planos" accept=".pdf,.jpg,.jpeg,.png,.dwg" required data-file-input="planos">
              <span class="helper-text">锔 OBLIGATORIO - Formatos: PDF, JPG, PNG, DWG (M谩x. 10MB)</span>
              <div class="file-preview" data-preview="planos">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="planos">Eliminar</button>
                </div>
              </div>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="mantenimiento">
              <label>2) Programa de mantenimiento</label>
              <input type="file" name="mantenimiento" accept=".pdf,.doc,.docx,.xls,.xlsx" data-file-input="mantenimiento">
              <span class="helper-text">Luminarias, maquinaria, sistema de tierras (seg煤n aplique)</span>
              <div class="file-preview" data-preview="mantenimiento">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="mantenimiento">Eliminar</button>
                </div>
              </div>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="proceso_produccion">
              <label>3) Proceso de producci贸n</label>
              <input type="file" name="proceso_produccion" accept=".pdf,.doc,.docx" data-file-input="proceso_produccion">
              <span class="helper-text">Solo si no lo describi贸 anteriormente</span>
              <div class="file-preview" data-preview="proceso_produccion">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="proceso_produccion">Eliminar</button>
                </div>
              </div>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="requisitos_ingreso">
              <label>4) Requisitos obligatorios para ingresar a planta</label>
              <input type="file" name="requisitos_ingreso" accept=".pdf,.doc,.docx" data-file-input="requisitos_ingreso">
              <span class="helper-text">EPP, documentaci贸n u otros</span>
              <div class="file-preview" data-preview="requisitos_ingreso">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="requisitos_ingreso">Eliminar</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Documentaci贸n Legal (Recipientes/Calderas)</div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label style="font-size:13px; text-transform:none;">
                驴El servicio es para evaluaci贸n de NOM-020-STPS-2011 (Recipientes sujetos a presi贸n, recipientes criog茅nicos y generadores de vapor o calderas)?<span class="required">*</span>
              </label>
              <div class="radio-group">
                <div class="radio-option">
                  <input type="radio" id="nom020_si" name="aplica_nom020" value="si" required>
                  <label for="nom020_si">S铆, tenemos equipos de este tipo</label>
                </div>
                <div class="radio-option">
                  <input type="radio" id="nom020_no" name="aplica_nom020" value="no">
                  <label for="nom020_no">No, no aplica para nosotros</label>
                </div>
              </div>
            </div>
          </div>

          <div id="documentacionLegalSection" class="conditional-section">
            <div class="conditional-header">锔 DOCUMENTACIN OBLIGATORIA PARA NOM-020-STPS</div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="ine_atencion">
                <label>A) INE de quien nos atender谩<span class="required">*</span></label>
                <input type="file" name="ine_atencion" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_atencion" data-conditional-required="nom020">
                <span class="helper-text">Copia por ambos lados</span>
                <div class="file-preview" data-preview="ine_atencion">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="ine_atencion">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group">
                <label>B) Nombre y puesto Testigo 1<span class="required">*</span></label>
                <input type="text" name="testigo1" data-conditional-required="nom020">
              </div>
              <div class="form-group file-upload-group" data-upload-group="ine_testigo1">
                <label>INE Testigo 1<span class="required">*</span></label>
                <input type="file" name="ine_testigo1" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_testigo1" data-conditional-required="nom020">
                <span class="helper-text">Ambos lados</span>
                <div class="file-preview" data-preview="ine_testigo1">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="ine_testigo1">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group">
                <label>C) Nombre y puesto Testigo 2<span class="required">*</span></label>
                <input type="text" name="testigo2" data-conditional-required="nom020">
              </div>
              <div class="form-group file-upload-group" data-upload-group="ine_testigo2">
                <label>INE Testigo 2<span class="required">*</span></label>
                <input type="file" name="ine_testigo2" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_testigo2" data-conditional-required="nom020">
                <span class="helper-text">Ambos lados</span>
                <div class="file-preview" data-preview="ine_testigo2">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="ine_testigo2">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="poder_notarial">
                <label>D) Poder notarial<span class="required">*</span></label>
                <input type="file" name="poder_notarial" accept=".pdf" data-file-input="poder_notarial" data-conditional-required="nom020">
                <div class="file-preview" data-preview="poder_notarial">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="poder_notarial">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="ine_representante">
                <label>E) INE del representante legal<span class="required">*</span></label>
                <input type="file" name="ine_representante" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_representante" data-conditional-required="nom020">
                <span class="helper-text">Copia por ambos lados</span>
                <div class="file-preview" data-preview="ine_representante">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="ine_representante">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="situacion_fiscal">
                <label>F) Constancia de situaci贸n fiscal<span class="required">*</span></label>
                <input type="file" name="situacion_fiscal" accept=".pdf" data-file-input="situacion_fiscal" data-conditional-required="nom020">
                <div class="file-preview" data-preview="situacion_fiscal">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="situacion_fiscal">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="licencia">
                <label>G) Licencia de uso de suelo / Licencia de funcionamiento / C茅dula IMSS<span class="required">*</span></label>
                <input type="file" name="licencia" accept=".pdf" data-file-input="licencia" data-conditional-required="nom020">
                <div class="file-preview" data-preview="licencia">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="licencia">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="dc3">
                <label>H) DC-3 de personal operador<span class="required">*</span></label>
                <input type="file" name="dc3" accept=".pdf" data-file-input="dc3" data-conditional-required="nom020">
                <span class="helper-text">Recipientes a presi贸n o fogonero (calderas)</span>
                <div class="file-preview" data-preview="dc3">
                  <div class="file-preview-content">
                    <div class="file-info"><span class="file-icon"></span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                    <button type="button" class="file-remove" data-clear="dc3">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Programa Interno de Protecci贸n Civil (PIPC)</div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label style="font-size: 13px; text-transform: none;">驴Requiere servicio de Programa Interno de Protecci贸n Civil?<span class="required">*</span></label>
              <div class="radio-group">
                <div class="radio-option">
                  <input type="radio" id="pipc_si" name="requiere_pipc" value="si" required>
                  <label for="pipc_si">S铆, requiero PIPC</label>
                </div>
                <div class="radio-option">
                  <input type="radio" id="pipc_no" name="requiere_pipc" value="no">
                  <label for="pipc_no">No, no requiero PIPC</label>
                </div>
              </div>
            </div>
          </div>

          <div id="documentacionPIPCSection" class="conditional-section">
            <div class="conditional-header">
               DOCUMENTACIN REQUERIDA PARA PIPC
            </div>

            <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; border-radius: 5px; margin-bottom: 25px;">
              <p style="margin: 0; color: #1565c0; font-size: 12px; line-height: 1.6;">
                <strong>癸 NOTA IMPORTANTE:</strong> Los requisitos presentados a continuaci贸n son la <strong>base m铆nima</strong> para el Programa Interno de Protecci贸n Civil.
                Sin embargo, <strong>algunos municipios de Puebla pueden solicitar documentaci贸n adicional</strong> seg煤n sus normativas locales.
                En caso de que su municipio requiera requisitos extra, <strong>Atenci贸n a Clientes se comunicar谩 con usted</strong> para informarle qu茅 documentos adicionales son necesarios.
              </p>
            </div>

            <h4 style="color: #1e5a3e; margin: 0 0 15px 0; font-size: 13px; text-transform: uppercase; border-bottom: 2px solid #1e5a3e; padding-bottom: 8px;">
               Documentos Base (Siempre Obligatorios)
            </h4>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_licencia_funcionamiento">
                <label>1) Licencia de funcionamiento (Tesorer铆a Municipal)<span class="required">*</span></label>
                <input type="file" name="pipc_licencia_funcionamiento" accept=".pdf,.jpg,.jpeg,.png" data-file-input="pipc_licencia_funcionamiento" data-conditional-required="pipc">
                <div class="file-preview" data-preview="pipc_licencia_funcionamiento">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_licencia_funcionamiento">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_uso_suelo">
                <label>2) Licencia de uso de suelo espec铆fico (posterior a 1997)<span class="required">*</span></label>
                <input type="file" name="pipc_uso_suelo" accept=".pdf,.jpg,.jpeg,.png" data-file-input="pipc_uso_suelo" data-conditional-required="pipc">
                <span class="helper-text">Expedida por Direcci贸n de Desarrollo Urbano</span>
                <div class="file-preview" data-preview="pipc_uso_suelo">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_uso_suelo">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_predial">
                <label>3) Predial<span class="required">*</span></label>
                <input type="file" name="pipc_predial" accept=".pdf,.jpg,.jpeg,.png" data-file-input="pipc_predial" data-conditional-required="pipc">
                <div class="file-preview" data-preview="pipc_predial">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_predial">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_poliza_seguro">
                <label>4) P贸liza de seguro de responsabilidad civil (Vigente)<span class="required">*</span></label>
                <input type="file" name="pipc_poliza_seguro" accept=".pdf" data-file-input="pipc_poliza_seguro" data-conditional-required="pipc">
                <div class="file-preview" data-preview="pipc_poliza_seguro">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_poliza_seguro">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_mant_extintores">
                <label>5) Comprobante de mantenimiento a extintores<span class="required">*</span></label>
                <input type="file" name="pipc_mant_extintores" accept=".pdf,.jpg,.jpeg,.png" data-file-input="pipc_mant_extintores" data-conditional-required="pipc">
                <span class="helper-text">Factura, carta garant铆a o dictamen</span>
                <div class="file-preview" data-preview="pipc_mant_extintores">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_mant_extintores">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_situacion_fiscal">
                <label>6) Constancia de Situaci贸n Fiscal (Actualizada)<span class="required">*</span></label>
                <input type="file" name="pipc_situacion_fiscal" accept=".pdf" data-file-input="pipc_situacion_fiscal" data-conditional-required="pipc">
                <div class="file-preview" data-preview="pipc_situacion_fiscal">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_situacion_fiscal">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_ine_representante">
                <label>7) INE del representante legal o propietario<span class="required">*</span></label>
                <input type="file" name="pipc_ine_representante" accept=".pdf,.jpg,.jpeg,.png" data-file-input="pipc_ine_representante" data-conditional-required="pipc">
                <div class="file-preview" data-preview="pipc_ine_representante">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_ine_representante">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_acta_constitutiva">
                <label>8) Acta Constitutiva<span class="required">*</span></label>
                <input type="file" name="pipc_acta_constitutiva" accept=".pdf" data-file-input="pipc_acta_constitutiva" data-conditional-required="pipc">
                <span class="helper-text">Solo si el establecimiento est谩 registrado como persona moral</span>
                <div class="file-preview" data-preview="pipc_acta_constitutiva">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_acta_constitutiva">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_poder_notarial">
                <label>9) Poder Notarial<span class="required">*</span></label>
                <input type="file" name="pipc_poder_notarial" accept=".pdf" data-file-input="pipc_poder_notarial" data-conditional-required="pipc">
                <div class="file-preview" data-preview="pipc_poder_notarial">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_poder_notarial">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_evidencia_simulacros">
                <label>10) Evidencia fotogr谩fica de simulacros<span class="required">*</span></label>
                <input type="file" name="pipc_evidencia_simulacros" accept=".pdf,.jpg,.jpeg,.png,.zip" data-file-input="pipc_evidencia_simulacros" data-conditional-required="pipc">
                <span class="helper-text">Evidencia fotogr谩fica de los 煤ltimos simulacros realizados</span>
                <div class="file-preview" data-preview="pipc_evidencia_simulacros">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_evidencia_simulacros">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_organigrama_brigadas">
                <label>11) Organigrama de Brigadas<span class="required">*</span></label>
                <input type="file" name="pipc_organigrama_brigadas" accept=".pdf" data-file-input="pipc_organigrama_brigadas" data-conditional-required="pipc">
                <span class="helper-text">PDF con cronograma de personal que pertenece al equipo de brigadas (nombre completo y puesto)</span>
                <div class="file-preview" data-preview="pipc_organigrama_brigadas">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_organigrama_brigadas">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="pipc_detectores_humo">
                <label>12) Mantenimiento de detectores de humo<span class="required">*</span></label>
                <input type="file" name="pipc_detectores_humo" accept=".pdf,.xls,.xlsx" data-file-input="pipc_detectores_humo" data-conditional-required="pipc">
                <span class="helper-text">Bit谩cora de limpieza y reemplazo de bater铆as</span>
                <div class="file-preview" data-preview="pipc_detectores_humo">
                  <div class="file-preview-content">
                    <div class="file-info">
                      <span class="file-icon"></span>
                      <div>
                        <div class="file-name"></div>
                        <div class="file-size"></div>
                      </div>
                    </div>
                    <button type="button" class="file-remove" data-clear="pipc_detectores_humo">Eliminar</button>
                  </div>
                </div>
              </div>
            </div>

            <hr style="border: none; border-top: 2px solid #1e5a3e; margin: 30px 0;">

            <h4 style="color: #856404; margin: 0 0 15px 0; font-size: 13px; text-transform: uppercase; border-bottom: 2px solid #ffc107; padding-bottom: 8px;">
              锔 Documentos Adicionales (Seg煤n Aplique)
            </h4>

            <div class="form-grid">
              <div class="form-group full-width">
                <label style="font-size: 12px; text-transform: none; margin-bottom: 10px;">13) 驴Cuenta con constancia de medidas preventivas contra incendios?</label>
                <div class="radio-group">
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_medidas_si" name="pipc_tiene_medidas" value="si">
                    <label for="pipc_tiene_medidas_si">S铆, cuento con ella</label>
                  </div>
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_medidas_no" name="pipc_tiene_medidas" value="no">
                    <label for="pipc_tiene_medidas_no">No cuento con ella (debe tramitarse)</label>
                  </div>
                </div>
              </div>
            </div>

            <div id="pipc_medidas_preventivas_section" class="conditional-section" style="display: none; background: #fff9e6; border-left-color: #ff9800;">
              <div class="form-grid">
                <div class="form-group full-width file-upload-group" data-upload-group="pipc_medidas_preventivas">
                  <label>Adjuntar constancia de medidas preventivas<span class="required">*</span></label>
                  <input type="file" name="pipc_medidas_preventivas" accept=".pdf,.jpg,.jpeg,.png" data-file-input="pipc_medidas_preventivas" data-conditional-required="pipc_medidas">
                  <span class="helper-text">Solo si cuenta con ella</span>
                  <div class="file-preview" data-preview="pipc_medidas_preventivas">
                    <div class="file-preview-content">
                      <div class="file-info">
                        <span class="file-icon"></span>
                        <div>
                          <div class="file-name"></div>
                          <div class="file-size"></div>
                        </div>
                      </div>
                      <button type="button" class="file-remove" data-clear="pipc_medidas_preventivas">Eliminar</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid" style="margin-top: 20px;">
              <div class="form-group full-width">
                <label style="font-size: 12px; text-transform: none; margin-bottom: 10px;">14) 驴La instalaci贸n cuenta con suministro de Gas Natural?</label>
                <div class="radio-group">
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_gas_si" name="pipc_tiene_gas" value="si">
                    <label for="pipc_tiene_gas_si">S铆, contamos con Gas Natural</label>
                  </div>
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_gas_no" name="pipc_tiene_gas" value="no">
                    <label for="pipc_tiene_gas_no">No contamos con Gas Natural</label>
                  </div>
                </div>
              </div>
            </div>

            <div id="pipc_gas_natural_section" class="conditional-section" style="display: none; background: #fff9e6; border-left-color: #ff9800;">
              <div class="form-grid">
                <div class="form-group full-width file-upload-group" data-upload-group="pipc_gas_natural">
                  <label>Contrato y 3 煤ltimos comprobantes de pago de Gas Natural<span class="required">*</span></label>
                  <input type="file" name="pipc_gas_natural" accept=".pdf,.zip" data-file-input="pipc_gas_natural" data-conditional-required="pipc_gas">
                  <span class="helper-text">Puede adjuntar un PDF con todos los documentos o un archivo ZIP</span>
                  <div class="file-preview" data-preview="pipc_gas_natural">
                    <div class="file-preview-content">
                      <div class="file-info">
                        <span class="file-icon"></span>
                        <div>
                          <div class="file-name"></div>
                          <div class="file-size"></div>
                        </div>
                      </div>
                      <button type="button" class="file-remove" data-clear="pipc_gas_natural">Eliminar</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid" style="margin-top: 20px;">
              <div class="form-group full-width">
                <label style="font-size: 12px; text-transform: none; margin-bottom: 10px;">15) 驴Manejan sustancias qu铆micas peligrosas?</label>
                <div class="radio-group">
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_quimicos_si" name="pipc_tiene_quimicos" value="si">
                    <label for="pipc_tiene_quimicos_si">S铆, manejamos sustancias qu铆micas</label>
                  </div>
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_quimicos_no" name="pipc_tiene_quimicos" value="no">
                    <label for="pipc_tiene_quimicos_no">No manejamos sustancias qu铆micas</label>
                  </div>
                </div>
              </div>
            </div>

            <div id="pipc_sustancias_quimicas_section" class="conditional-section" style="display: none; background: #fff9e6; border-left-color: #ff9800;">
              <div class="form-grid">
                <div class="form-group full-width file-upload-group" data-upload-group="pipc_sustancias_quimicas">
                  <label>Evidencia de cumplimiento NOM-005-STPS-1998<span class="required">*</span></label>
                  <input type="file" name="pipc_sustancias_quimicas" accept=".pdf,.jpg,.jpeg,.png" data-file-input="pipc_sustancias_quimicas" data-conditional-required="pipc_quimicos">
                  <span class="helper-text">Almacenamiento de sustancias qu铆micas peligrosas</span>
                  <div class="file-preview" data-preview="pipc_sustancias_quimicas">
                    <div class="file-preview-content">
                      <div class="file-info">
                        <span class="file-icon"></span>
                        <div>
                          <div class="file-name"></div>
                          <div class="file-size"></div>
                        </div>
                      </div>
                      <button type="button" class="file-remove" data-clear="pipc_sustancias_quimicas">Eliminar</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-grid" style="margin-top: 20px;">
              <div class="form-group full-width">
                <label style="font-size: 12px; text-transform: none; margin-bottom: 10px;">16) 驴Cuentan con montacargas u operadores de maquinaria especializada?</label>
                <div class="radio-group">
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_montacargas_si" name="pipc_tiene_montacargas" value="si">
                    <label for="pipc_tiene_montacargas_si">S铆, contamos con ellos</label>
                  </div>
                  <div class="radio-option">
                    <input type="radio" id="pipc_tiene_montacargas_no" name="pipc_tiene_montacargas" value="no">
                    <label for="pipc_tiene_montacargas_no">No contamos con este equipo</label>
                  </div>
                </div>
              </div>
            </div>

            <div id="pipc_dc3_operadores_section" class="conditional-section" style="display: none; background: #fff9e6; border-left-color: #ff9800;">
              <div class="form-grid">
                <div class="form-group full-width file-upload-group" data-upload-group="pipc_dc3_operadores">
                  <label>DC-3 de operadores especializados<span class="required">*</span></label>
                  <input type="file" name="pipc_dc3_operadores" accept=".pdf" data-file-input="pipc_dc3_operadores" data-conditional-required="pipc_montacargas">
                  <span class="helper-text">Constancias de competencias de montacargas u otros operadores</span>
                  <div class="file-preview" data-preview="pipc_dc3_operadores">
                    <div class="file-preview-content">
                      <div class="file-info">
                        <span class="file-icon"></span>
                        <div>
                          <div class="file-name"></div>
                          <div class="file-size"></div>
                        </div>
                      </div>
                      <button type="button" class="file-remove" data-clear="pipc_dc3_operadores">Eliminar</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div style="background: #e8f5e9; border: 1px solid #4caf50; padding: 15px; border-radius: 5px; margin-top: 30px;">
              <h4 style="color: #2e7d32; margin: 0 0 10px 0; font-size: 13px;"> Verificaci贸n en sitio (no requiere documentos):</h4>
              <ul style="margin: 0; padding-left: 20px; color: #333; font-size: 11px; line-height: 1.8;">
                <li><strong>Punto de reuni贸n:</strong> Se帽al茅tica colocada o pintada</li>
                <li><strong>Alarma:</strong> Se帽al茅tica que identifique el medio de alertamiento</li>
                <li><strong>Delimitaci贸n de 谩reas:</strong> reas productivas y de almac茅n claramente delimitadas</li>
                <li><strong>Se帽al茅ticas de estiba m谩xima:</strong> En cada 谩rea correspondiente</li>
              </ul>
              <p style="margin: 10px 0 0 0; color: #666; font-size: 10px; font-style: italic;">
                Estos puntos se verificar谩n durante el levantamiento del servicio en su instalaci贸n
              </p>
            </div>
          </div>
        </div>

        <div class="submit-section">
          <button type="submit" class="btn-submit" id="submitBtn">Revisar y Enviar Informaci贸n</button>

          <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p class="loading-text"> Subiendo documentos a Drive...</p>
          </div>

          <div class="message success-message" id="successMsg">
            <strong>隆Informaci贸n enviada correctamente!</strong><br><br>
            Nuestro equipo revisar谩 la informaci贸n y se comunicar谩 con usted en las pr贸ximas <strong>24 horas</strong>.
          </div>

          <div class="message error-message" id="errorMsg">
             Error al enviar la informaci贸n. Por favor, intente nuevamente o cont谩ctenos directamente.
          </div>
        </div>
      </form>
    </div>
  </div>

  <div class="floating-buttons">
    <a href="tel:2229417295" class="floating-btn phone" title="Llamar ahora">
      <span class="floating-btn-tooltip">Llamar: 222 941 7295</span>
    </a>
    <a href="https://wa.me/522791113533" target="_blank" class="floating-btn whatsapp" title="WhatsApp">
      <span class="floating-btn-tooltip">WhatsApp: 279 111 3533</span>
    </a>
  </div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyMbddh70JDuLweBpkx_9mDe7X2QVSVPSL8Mgx9DvlNqW913X0JMpEnLkNmYr0pfcvW/exec';
    const MAX_FILE_SIZE = 10 * 1024 * 1024;
    const WELCOME_COOKIE_NAME = 'ea_welcome_shown';
    const WELCOME_COOKIE_DAYS = 30;

    // ==================== COOKIES ====================
    function setCookie(name, value, days) {
      const date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      document.cookie = `${name}=${value};expires=${date.toUTCString()};path=/`;
    }

    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let c of ca) {
        while (c.charAt(0) === ' ') c = c.substring(1);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length);
      }
      return null;
    }

    window.addEventListener('load', () => {
      if (!getCookie(WELCOME_COOKIE_NAME)) {
        setTimeout(() => {
          const wm = document.getElementById('welcomeModal');
          if (wm) wm.style.display = 'flex';
        }, 500);
      }
    });

    function closeWelcomeModal() {
      const wm = document.getElementById('welcomeModal');
      if (wm) wm.style.display = 'none';
      setCookie(WELCOME_COOKIE_NAME, 'true', WELCOME_COOKIE_DAYS);
    }
    window.closeWelcomeModal = closeWelcomeModal;

    // ==================== UTILIDADES ====================
    function formatFileSize(bytes) {
      if (!bytes) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];
    }

    function clearFileUI(fileKey) {
      const input = document.querySelector(`[data-file-input="${fileKey}"]`);
      const preview = document.querySelector(`[data-preview="${fileKey}"]`);
      const uploadGroup = document.querySelector(`[data-upload-group="${fileKey}"]`);
      if (input) input.value = '';
      if (preview) preview.classList.remove('active');
      if (uploadGroup) uploadGroup.classList.remove('has-file');
    }

    function clearConditionalFilesByAttr(attrValue) {
      document.querySelectorAll(`[data-conditional-required="${attrValue}"]`).forEach(field => {
        field.required = false;
        if (field.type === 'file') {
          const key = field.dataset.fileInput;
          if (key) clearFileUI(key);
          else field.value = '';
        }
      });
    }

    // ==================== PREVIEW DE ARCHIVOS ====================
    document.querySelectorAll('input[type="file"]').forEach(input => {
      input.addEventListener('change', function () {
        const fileKey = this.dataset.fileInput;
        const preview = document.querySelector(`[data-preview="${fileKey}"]`);
        const uploadGroup = document.querySelector(`[data-upload-group="${fileKey}"]`);
        if (!preview) return;

        if (this.files && this.files[0]) {
          const file = this.files[0];

          if (file.size > MAX_FILE_SIZE) {
            alert('El archivo es demasiado grande. M谩ximo 10MB por archivo.');
            this.value = '';
            preview.classList.remove('active');
            if (uploadGroup) uploadGroup.classList.remove('has-file');
            return;
          }

          const nameEl = preview.querySelector('.file-name');
          const sizeEl = preview.querySelector('.file-size');
          if (nameEl) nameEl.textContent = file.name;
          if (sizeEl) sizeEl.textContent = formatFileSize(file.size);

          preview.classList.add('active');
          if (uploadGroup) uploadGroup.classList.add('has-file');
        } else {
          preview.classList.remove('active');
          if (uploadGroup) uploadGroup.classList.remove('has-file');
        }
      });
    });

    document.querySelectorAll('.file-remove').forEach(btn => {
      btn.addEventListener('click', function () {
        const key = this.dataset.clear;
        if (key) clearFileUI(key);
      });
    });

    // ==================== NOM-020 ====================
    const docLegalSection = document.getElementById('documentacionLegalSection');

    document.querySelectorAll('input[name="aplica_nom020"]').forEach(r => {
      r.addEventListener('change', function () {
        const on = this.value === 'si';

        if (docLegalSection) docLegalSection.classList.toggle('active', on);

        // Required NOM-020
        document.querySelectorAll('[data-conditional-required="nom020"]').forEach(f => (f.required = on));

        // Si NO aplica, limpia archivos NOM-020
        if (!on) {
          document.querySelectorAll('[data-conditional-required="nom020"]').forEach(f => {
            if (f.type === 'file') {
              const key = f.dataset.fileInput;
              if (key) clearFileUI(key);
            } else {
              f.value = '';
            }
          });
        }
      });
    });

    // ==================== PIPC ====================
    const docPIPCSection = document.getElementById('documentacionPIPCSection');
    const radioPIPC = document.querySelectorAll('input[name="requiere_pipc"]');

    // Sub-secciones
    const radioMedidas = document.querySelectorAll('input[name="pipc_tiene_medidas"]');
    const sectionMedidas = document.getElementById('pipc_medidas_preventivas_section');

    const radioGas = document.querySelectorAll('input[name="pipc_tiene_gas"]');
    const sectionGas = document.getElementById('pipc_gas_natural_section');

    const radioQuimicos = document.querySelectorAll('input[name="pipc_tiene_quimicos"]');
    const sectionQuimicos = document.getElementById('pipc_sustancias_quimicas_section');

    const radioMontacargas = document.querySelectorAll('input[name="pipc_tiene_montacargas"]');
    const sectionMontacargas = document.getElementById('pipc_dc3_operadores_section');

    function resetPIPCConditionals() {
      // Reset radios de sub-secciones
      document.querySelectorAll('input[name^="pipc_tiene_"]').forEach(r => (r.checked = false));

      // Ocultar secciones
      if (sectionMedidas) sectionMedidas.style.display = 'none';
      if (sectionGas) sectionGas.style.display = 'none';
      if (sectionQuimicos) sectionQuimicos.style.display = 'none';
      if (sectionMontacargas) sectionMontacargas.style.display = 'none';

      // Quitar required y limpiar archivos de sub-secciones
      clearConditionalFilesByAttr('pipc_medidas');
      clearConditionalFilesByAttr('pipc_gas');
      clearConditionalFilesByAttr('pipc_quimicos');
      clearConditionalFilesByAttr('pipc_montacargas');
    }

    radioPIPC.forEach(radio => {
      radio.addEventListener('change', function () {
        if (!docPIPCSection) return;

        const on = this.value === 'si';
        docPIPCSection.classList.toggle('active', on);

        // Base PIPC required
        document.querySelectorAll('[data-conditional-required="pipc"]').forEach(field => {
          field.required = on;
        });

        // Si NO requiere, limpiar base + subsecciones
        if (!on) {
          document.querySelectorAll('[data-conditional-required="pipc"]').forEach(field => {
            field.required = false;
            if (field.type === 'file') {
              const key = field.dataset.fileInput;
              if (key) clearFileUI(key);
            } else {
              field.value = '';
            }
          });
          resetPIPCConditionals();
        }
      });
    });

    // Medidas preventivas
    radioMedidas.forEach(radio => {
      radio.addEventListener('change', function () {
        if (!sectionMedidas) return;

        if (this.value === 'si') {
          sectionMedidas.style.display = 'block';
          document.querySelectorAll('[data-conditional-required="pipc_medidas"]').forEach(f => (f.required = true));
        } else {
          sectionMedidas.style.display = 'none';
          clearConditionalFilesByAttr('pipc_medidas');
        }
      });
    });

    // Gas Natural
    radioGas.forEach(radio => {
      radio.addEventListener('change', function () {
        if (!sectionGas) return;

        if (this.value === 'si') {
          sectionGas.style.display = 'block';
          document.querySelectorAll('[data-conditional-required="pipc_gas"]').forEach(f => (f.required = true));
        } else {
          sectionGas.style.display = 'none';
          clearConditionalFilesByAttr('pipc_gas');
        }
      });
    });

    // Sustancias qu铆micas
    radioQuimicos.forEach(radio => {
      radio.addEventListener('change', function () {
        if (!sectionQuimicos) return;

        if (this.value === 'si') {
          sectionQuimicos.style.display = 'block';
          document.querySelectorAll('[data-conditional-required="pipc_quimicos"]').forEach(f => (f.required = true));
        } else {
          sectionQuimicos.style.display = 'none';
          clearConditionalFilesByAttr('pipc_quimicos');
        }
      });
    });

    // Montacargas/Operadores
    radioMontacargas.forEach(radio => {
      radio.addEventListener('change', function () {
        if (!sectionMontacargas) return;

        if (this.value === 'si') {
          sectionMontacargas.style.display = 'block';
          document.querySelectorAll('[data-conditional-required="pipc_montacargas"]').forEach(f => (f.required = true));
        } else {
          sectionMontacargas.style.display = 'none';
          clearConditionalFilesByAttr('pipc_montacargas');
        }
      });
    });

    // ==================== RFC ====================
    const rfcInput = document.querySelector('input[name="rfc"]');
    if (rfcInput) {
      rfcInput.addEventListener('input', function () {
        this.value = this.value.toUpperCase();
        if (this.value.length >= 12) {
          const rfcPattern = /^[A-Z&]{3,4}[0-9]{6}[A-Z0-9]{3}$/;
          this.style.borderColor = rfcPattern.test(this.value) ? '#28a745' : '#dc3545';
        }
      });
    }

    // ==================== MODAL ====================
    function closeConfirmationModal() {
      const cm = document.getElementById('confirmationModal');
      if (cm) cm.classList.remove('active');
    }
    window.closeConfirmationModal = closeConfirmationModal;

    const formMain = document.getElementById('perfilDatosForm');
    if (formMain) {
      formMain.addEventListener('submit', function (e) {
        e.preventDefault();
        showConfirmationModal();
      });
    }

    function showConfirmationModal() {
      const form = document.getElementById('perfilDatosForm');
      const formData = new FormData(form);

      let filesCount = 0;
      const filesInfo = [];
      document.querySelectorAll('input[type="file"]').forEach(input => {
        if (input.files && input.files[0]) {
          filesCount++;
          const labelEl = input.parentElement?.querySelector('label');
          filesInfo.push({
            label: labelEl ? labelEl.textContent.replace('*', '').trim() : input.name,
            name: input.files[0].name,
            size: formatFileSize(input.files[0].size)
          });
        }
      });

      let confirmationHTML = `
        <div class="confirmation-section">
          <h3> DATOS GENERALES</h3>
          <div class="confirmation-item"><span class="confirmation-label">Raz贸n Social:</span><span class="confirmation-value">${formData.get('razon_social') || ''}</span></div>
          <div class="confirmation-item"><span class="confirmation-label">RFC:</span><span class="confirmation-value">${formData.get('rfc') || ''}</span></div>
          <div class="confirmation-item"><span class="confirmation-label">Responsable:</span><span class="confirmation-value">${formData.get('responsable') || ''}</span></div>
          <div class="confirmation-item"><span class="confirmation-label">Correo para informe:</span><span class="confirmation-value" style="font-weight:bold;color:#1e5a3e;">${formData.get('correo_informe') || ''}</span></div>
        </div>

        <div class="confirmation-section">
          <h3> ARCHIVOS ADJUNTOS (${filesCount} archivos)</h3>
          ${filesCount > 0 ? `
            <ul class="file-list">
              ${filesInfo.map(f => `<li> ${f.label} <br><strong>${f.name}</strong> (${f.size})</li>`).join('')}
            </ul>
          ` : '<p style="color:#856404;">锔 No se adjuntaron archivos</p>'}
        </div>
      `;

      const aplicaNom020 = formData.get('aplica_nom020');
      confirmationHTML += `
        <div class="confirmation-section">
          <h3>锔 DOCUMENTACIN NOM-020-STPS</h3>
          <p>${aplicaNom020 === 'si' ? '<strong>Aplica</strong> evaluaci贸n de recipientes/calderas' : 'No aplica para este cliente'}</p>
        </div>
      `;

      const requierePIPC = formData.get('requiere_pipc');
      if (requierePIPC === 'si') {
        confirmationHTML += `
          <div class="confirmation-section">
            <h3>Н PROTECCIN CIVIL (PIPC)</h3>
            <p style="color:#1e5a3e; font-weight:bold;">S铆 requiere PIPC (se validar谩 documentaci贸n)</p>
          </div>
        `;
      } else if (requierePIPC === 'no') {
        confirmationHTML += `
          <div class="confirmation-section">
            <h3>Н PROTECCIN CIVIL (PIPC)</h3>
            <p>No requiere PIPC</p>
          </div>
        `;
      }

      confirmationHTML += `
        <div class="warning-box">
          <p><strong>锔 IMPORTANTE:</strong> Verifique que toda la informaci贸n sea correcta antes de enviar. El correo electr贸nico es especialmente importante.</p>
        </div>

        <div class="modal-buttons">
          <button type="button" class="btn-modal btn-confirm" onclick="confirmAndSend()"> Confirmar y Enviar</button>
          <button type="button" class="btn-modal btn-cancel" onclick="closeConfirmationModal()"> Corregir Datos</button>
        </div>
      `;

      document.getElementById('confirmationContent').innerHTML = confirmationHTML;
      document.getElementById('confirmationModal').classList.add('active');
    }

    // ==================== ENVO ====================
    async function confirmAndSend() {
      closeConfirmationModal();

      const form = document.getElementById('perfilDatosForm');
      const submitBtn = document.getElementById('submitBtn');
      const loading = document.getElementById('loading');
      const successMsg = document.getElementById('successMsg');
      const errorMsg = document.getElementById('errorMsg');

      if (successMsg) successMsg.style.display = 'none';
      if (errorMsg) errorMsg.style.display = 'none';
      if (submitBtn) submitBtn.disabled = true;
      if (loading) loading.style.display = 'block';

      try {
        const formData = new FormData(form);
        const data = {};

        for (let [key, value] of formData.entries()) {
          if (value instanceof File && value.size > 0) {
            data[key] = await fileToBase64(value);
            data[key + '_filename'] = value.name;
            data[key + '_size'] = value.size;
          } else {
            data[key] = value;
          }
        }

        const response = await fetch(SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'text/plain' },
          body: JSON.stringify(data)
        });

        let result;
        try { result = await response.json(); } catch { result = { success: true }; }

        if (result.success !== false) {
          if (loading) loading.style.display = 'none';
          if (successMsg) successMsg.style.display = 'block';

          form.reset();

          // Reset previews
          document.querySelectorAll('.file-preview').forEach(p => p.classList.remove('active'));
          document.querySelectorAll('.file-upload-group').forEach(g => g.classList.remove('has-file'));

          // Ocultar secciones condicionales + limpiar requireds
          if (docLegalSection) docLegalSection.classList.remove('active');
          document.querySelectorAll('[data-conditional-required="nom020"]').forEach(f => (f.required = false));

          if (docPIPCSection) docPIPCSection.classList.remove('active');
          document.querySelectorAll('[data-conditional-required="pipc"]').forEach(f => (f.required = false));
          resetPIPCConditionals();

          if (successMsg) successMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
        } else {
          throw new Error(result.error || 'Error desconocido');
        }
      } catch (error) {
        console.error(error);
        if (loading) loading.style.display = 'none';
        if (errorMsg) errorMsg.style.display = 'block';
        if (errorMsg) errorMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
      } finally {
        if (submitBtn) submitBtn.disabled = false;
      }
    }
    window.confirmAndSend = confirmAndSend;

    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
      });
    }
  </script>
</body>
</html>
