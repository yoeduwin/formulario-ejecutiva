<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil de Datos - Ejecutiva Ambiental v6.0</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: Arial, sans-serif; background:#f5f5f5; padding:20px; font-size:12px; }
    .main-container { max-width:1200px; margin:0 auto; background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,.1); overflow:hidden; }

    .header { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:#fff; padding:25px 30px; display:flex; justify-content:space-between; align-items:center; }
    .logo-section { display:flex; align-items:center; gap:15px; }
    .logo { width:50px; height:50px; background:#fff; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#1e5a3e; font-weight:bold; font-size:20px; }
    .company-info h1 { margin:0; font-size:18px; font-weight:bold; }
    .company-info p { margin:3px 0 0 0; font-size:10px; opacity:.95; max-width:500px; }
    .document-info h2 { margin:0; font-size:22px; font-weight:bold; text-align:right; }
    .document-info p { margin:3px 0 0 0; font-size:11px; opacity:.9; text-align:right; }

    .form-content { padding:30px 40px; }
    .section { border-bottom:1px solid #e0e0e0; margin-bottom:30px; padding-bottom:25px; }
    .section:last-child { border-bottom:none; }
    .section-header { background:#1e5a3e; color:#fff; padding:10px 20px; margin:0 -40px 25px -40px; font-weight:bold; font-size:12px; text-transform:uppercase; letter-spacing:.5px; }

    .form-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px; }
    .form-group { display:flex; flex-direction:column; }
    .form-group.full-width { grid-column: 1 / -1; }

    label { font-weight:bold; color:#333; margin-bottom:6px; font-size:11px; text-transform:uppercase; }
    label .required { color:#dc3545; margin-left:3px; }
    label .optional { color:#6c757d; font-weight:normal; text-transform:none; margin-left:5px; font-size:10px; }

    input[type="text"], input[type="email"], input[type="tel"], input[type="number"],
    textarea, select, input[type="file"] {
      border:1px solid #ccc; padding:8px 10px; font-size:11px; border-radius:3px;
      background:#f9f9f9; font-family:inherit; transition:all .2s;
    }
    input:focus, textarea:focus, select:focus { outline:none; border-color:#1e5a3e; background:#fff; box-shadow:0 0 0 2px rgba(30,90,62,.1); }
    textarea { resize:vertical; min-height:80px; font-family: Arial, sans-serif; }
    input[type="file"] { padding:6px 8px; cursor:pointer; font-size:10px; }
    .helper-text { font-size:10px; color:#666; margin-top:4px; font-style:italic; }

    .file-preview { margin-top:8px; padding:8px 12px; background:#e8f5e9; border-left:3px solid #4caf50; border-radius:3px; font-size:11px; display:none; }
    .file-preview.active { display:block; }
    .file-preview-content { display:flex; align-items:center; justify-content:space-between; }
    .file-info { display:flex; align-items:center; gap:8px; }
    .file-icon { font-size:16px; }
    .file-name { font-weight:600; color:#2e7d32; }
    .file-size { color:#666; font-size:10px; }
    .file-remove { background:#dc3545; color:white; border:none; padding:4px 10px; border-radius:3px; cursor:pointer; font-size:10px; transition:background .2s; }
    .file-remove:hover { background:#c82333; }

    .radio-group { display:flex; gap:20px; margin-top:10px; }
    .radio-option { display:flex; align-items:center; gap:8px; cursor:pointer; }
    .radio-option input[type="radio"] { width:18px; height:18px; cursor:pointer; }
    .radio-option label { margin:0; cursor:pointer; text-transform:none; font-weight:normal; }

    .conditional-section { display:none; margin-top:20px; padding:20px; background:#fff3cd; border-left:4px solid #ffc107; border-radius:5px; }
    .conditional-section.active { display:block; }
    .conditional-header { font-weight:bold; color:#856404; margin-bottom:15px; font-size:12px; }

    .submit-section { margin-top:40px; padding-top:30px; border-top:2px solid #e0e0e0; text-align:center; }
    .btn-submit { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; padding:15px 50px; font-size:14px; font-weight:600; border:none; border-radius:5px; cursor:pointer; transition: all .3s ease; box-shadow:0 4px 15px rgba(30,90,62,.3); text-transform:uppercase; letter-spacing:.5px; }
    .btn-submit:hover { transform: translateY(-2px); box-shadow:0 6px 20px rgba(30,90,62,.4); }
    .btn-submit:disabled { opacity:.6; cursor:not-allowed; transform:none; }

    .message { padding:15px 20px; border-radius:5px; margin-top:20px; display:none; text-align:left; font-weight:500; font-size:13px; line-height:1.8; }
    .success-message { background:#d4edda; color:#155724; border:1px solid #c3e6cb; }
    .error-message { background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }

    .loading { display:none; text-align:center; margin-top:20px; }
    .loading-spinner { border:3px solid #f3f3f3; border-top:3px solid #1e5a3e; border-radius:50%; width:40px; height:40px; animation: spin 1s linear infinite; margin:0 auto; }
    @keyframes spin { 0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)} }
    .loading-text { margin-top:15px; color:#1e5a3e; font-weight:500; }

    .floating-buttons { position:fixed; bottom:30px; right:30px; display:flex; flex-direction:column; gap:15px; z-index:1000; }
    .floating-btn { width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none; font-size:28px; box-shadow:0 4px 15px rgba(0,0,0,.3); transition:all .3s ease; cursor:pointer; }
    .floating-btn:hover { transform: translateY(-5px); box-shadow:0 6px 20px rgba(0,0,0,.4); }
    .floating-btn.phone { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; }
    .floating-btn.whatsapp { background:#25D366; color:white; }
    .floating-btn-tooltip { position:absolute; right:75px; background:rgba(0,0,0,.8); color:white; padding:8px 15px; border-radius:5px; white-space:nowrap; font-size:13px; opacity:0; pointer-events:none; transition:opacity .3s; }
    .floating-btn:hover .floating-btn-tooltip { opacity:1; }

    /* CAMBIO 1: Estilo de Versi√≥n */
    .version-tag { position:fixed; bottom:10px; left:10px; background:rgba(30,90,62,0.1); color:#1e5a3e; padding:4px 10px; border-radius:4px; font-size:10px; font-weight:600; z-index:100; border:1px solid rgba(30,90,62,0.2); }

    .modal-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.8); z-index:9999; justify-content:center; align-items:center; overflow-y:auto; padding:20px; }
    .modal-overlay.active { display:flex; }
    .modal-content { background:white; border-radius:10px; max-width:800px; width:100%; max-height:90vh; overflow-y:auto; box-shadow:0 10px 40px rgba(0,0,0,.3); }
    .modal-header { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; padding:20px 30px; border-radius:10px 10px 0 0; }
    .modal-header h2 { margin:0; font-size:20px; }
    .modal-body { padding:30px; }
    .confirmation-section { margin-bottom:25px; padding-bottom:20px; border-bottom:1px solid #e0e0e0; }
    .confirmation-section:last-child { border-bottom:none; }
    .confirmation-section h3 { color:#1e5a3e; font-size:14px; margin-bottom:15px; display:flex; align-items:center; gap:10px; }
    .confirmation-item { display:flex; justify-content:space-between; padding:8px 0; font-size:12px; }
    .confirmation-label { font-weight:bold; color:#666; }
    .confirmation-value { color:#333; text-align:right; max-width:60%; }
    .file-list { list-style:none; padding:0; }
    .file-list li { padding:8px 12px; background:#f0f9f4; margin-bottom:5px; border-radius:3px; font-size:11px; display:flex; align-items:center; gap:8px; }
    .warning-box { background:#fff3cd; border-left:4px solid #ffc107; padding:15px; border-radius:5px; margin-top:20px; }
    .warning-box p { margin:0; color:#856404; font-size:12px; line-height:1.6; }
    .modal-buttons { display:flex; gap:15px; justify-content:center; margin-top:30px; }
    .btn-modal { padding:12px 30px; border:none; border-radius:5px; font-size:13px; font-weight:600; cursor:pointer; transition:all .3s; }
    .btn-confirm { background: linear-gradient(135deg, #1e5a3e, #2d7a4f); color:white; }
    .btn-cancel { background:#6c757d; color:white; }

    @media (max-width:768px){
      body{padding:10px;}
      .form-grid{grid-template-columns:1fr;}
      .form-content{padding:20px;}
      .section-header{margin:0 -20px 20px -20px;}
      .header{flex-direction:column; gap:15px; text-align:center;}
      .document-info h2,.document-info p{ text-align:center; }
      .floating-buttons{bottom:20px; right:20px; gap:12px;}
      .floating-btn{width:55px; height:55px; font-size:24px;}
      .floating-btn-tooltip{display:none;}
      .modal-body{padding:20px;}
      .modal-buttons{flex-direction:column;}
      .version-tag{font-size:9px; padding:3px 8px;}
    }

    .file-upload-group { border:2px dashed #ccc; border-radius:5px; padding:15px; background:#fafafa; transition:all .3s; }
    .file-upload-group:hover { border-color:#1e5a3e; background:#f0f9f4; }
    .file-upload-group.has-file { border-color:#4caf50; background:#e8f5e9; }
    .file-upload-group label { margin-bottom:8px; }
  </style>
</head>

<body>
  <div class="version-tag">v6.0</div>

  <div id="welcomeModal" class="modal-overlay">
    <div style="background: white; border-radius: 10px; max-width: 600px; width: 90%; padding: 40px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
      <div style="width: 80px; height: 80px; background: #1e5a3e; border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; color: white; font-size: 40px; font-weight: bold;">EA</div>
      <h2 style="color: #1e5a3e; margin: 0 0 20px 0; font-size: 24px;">¬°Bienvenido!</h2>
      <p style="color: #333; font-size: 16px; line-height: 1.6; margin-bottom: 15px;"><strong>ESTIMADO CLIENTE,</strong></p>
      <p style="color: #666; font-size: 15px; line-height: 1.8; margin-bottom: 20px;">
        Hemos creado esta plataforma para mejorar su experiencia con nosotros. Es por ello que le agradecemos enormemente su confianza.
      </p>
      <div style="background: #f0f9f4; border-left: 4px solid #1e5a3e; padding: 20px; margin: 25px 0; border-radius: 5px;">
        <p style="color: #1e5a3e; font-size: 14px; margin: 0; font-weight: 500;">
          <strong>¬øTiene alguna duda?</strong><br>
          <span style="color: #666; font-weight: normal;">Por favor, no dude en comunicarse con nosotros:</span>
        </p>
      </div>
      <div style="display: flex; gap: 15px; justify-content: center; margin: 30px 0;">
        <a href="tel:2229417295" style="flex: 1; background: #1e5a3e; color: white; padding: 15px 20px; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; display:flex; align-items:center; justify-content:center; gap:8px;">
          <span style="font-size: 20px;">üìû</span> Llamar Ahora
        </a>
        <a href="https://wa.me/522791113533" target="_blank" style="flex: 1; background: #25D366; color: white; padding: 15px 20px; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; display:flex; align-items:center; justify-content:center; gap:8px;">
          <span style="font-size: 20px;">üí¨</span> WhatsApp
        </a>
      </div>
      <button onclick="closeWelcomeModal()" style="background: #6c757d; color: white; border: none; padding: 12px 40px; border-radius: 5px; font-size: 15px; font-weight: 600; cursor: pointer;">
        Continuar al Formulario
      </button>
    </div>
  </div>

  <div id="confirmationModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header"><h2>‚ö†Ô∏è Verificar Informaci√≥n Antes de Enviar</h2></div>
      <div class="modal-body" id="confirmationContent"></div>
    </div>
  </div>

  <div class="main-container">
    <div class="header">
      <div class="logo-section">
        <div class="logo">EA</div>
        <div class="company-info">
          <h1>EJECUTIVA AMBIENTAL</h1>
          <p>SEGURIDAD E HIGIENE, CAPACITACI√ìN, MANTENIMIENTO INDUSTRIAL, PROTECCI√ìN CIVIL, MEDIO AMBIENTE</p>
        </div>
      </div>
      <div class="document-info">
        <h2>PERFIL DE DATOS</h2>
        <p>Informaci√≥n del Cliente</p>
      </div>
    </div>

    <div class="form-content">
      <form id="perfilDatosForm">
        <div class="section">
          <div class="section-header">Informaci√≥n General</div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Nombre y puesto solicitante<span class="required">*</span></label>
              <input type="text" name="nombre_solicitante" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Denominaci√≥n/Raz√≥n social<span class="required">*</span></label>
              <input type="text" name="razon_social" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Sucursal<span class="required">*</span></label>
              <input type="text" name="sucursal" required placeholder="Ejemplo: Fragua, Corporativo, Matriz, Suc. Veracruz, entre otros">
              <span class="helper-text">Especifique el nombre de la sucursal o planta, para fines de identificaci√≥n interna</span>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label>RFC<span class="required">*</span></label>
              <input type="text" name="rfc" required maxlength="13" style="text-transform: uppercase;">
            </div>
            <div class="form-group">
              <label>Tel√©fono empresa<span class="required">*</span></label>
              <input type="tel" name="telefono_empresa" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Representante legal<span class="required">*</span></label>
              <input type="text" name="representante_legal" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Direcci√≥n donde se evaluar√°<span class="required">*</span></label>
              <input type="text" name="direccion_evaluacion" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label>Responsable de atendernos<span class="required">*</span></label>
              <input type="text" name="responsable" required>
            </div>
            <div class="form-group">
              <label>Tel√©fono<span class="required">*</span></label>
              <input type="tel" name="telefono_responsable" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Giro de la empresa<span class="required">*</span></label>
              <input type="text" name="giro" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Actividad principal</label>
              <input type="text" name="actividad_principal">
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label>Registro patronal</label>
              <input type="text" name="registro_patronal">
            </div>
            <div class="form-group">
              <label>Capacidad instalada</label>
              <input type="text" name="capacidad_instalada">
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Capacidad de operaci√≥n</label>
              <input type="text" name="capacidad_operacion">
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>D√≠as, turnos y horarios de trabajo<span class="required">*</span></label>
              <textarea name="dias_turnos_horarios" required placeholder="Ej: Lunes a Viernes, 2 turnos (8:00-16:00 y 16:00-00:00)"></textarea>
              <span class="helper-text">Especifique los d√≠as de la semana, n√∫mero de turnos y horarios</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Sobre el Informe de Resultados</div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Nombre de a qui√©n se dirige<span class="required">*</span></label>
              <input type="text" name="nombre_dirigido" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Puesto de a qui√©n se dirige<span class="required">*</span></label>
              <input type="text" name="puesto_dirigido" required>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label>Correo electr√≥nico para enviar el informe digital<span class="required">*</span></label>
              <input type="email" name="correo_informe" required>
              <span class="helper-text">‚ö†Ô∏è Verifique que el correo sea correcto - aqu√≠ recibir√° su informe mediante nuestra plataforma</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Coordinaci√≥n de Evaluaci√≥n</div>
          <div class="form-grid">
            <div class="form-group full-width">
              <label>Fechas preferidas para evaluaci√≥n en sitio<span class="required">*</span></label>
              <textarea name="fechas_preferidas" required placeholder="Ej: Preferimos la primera semana de febrero o tercera semana de marzo" rows="3"></textarea>
              <span class="helper-text">‚ö†Ô∏è OBLIGATORIO - Esto nos ayuda a coordinar mejor la visita. Indique rangos de fechas o semanas de preferencia</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Descripci√≥n del Proceso</div>
          <div class="form-grid">
            <div class="form-group full-width">
              <label>Breve descripci√≥n del proceso operativo o productivo</label>
              <textarea name="descripcion_proceso" placeholder="Describa brevemente el proceso operativo de su empresa..."></textarea>
              <span class="helper-text">Tambi√©n puede adjuntar documento m√°s adelante</span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Archivos Adjuntos</div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="planos">
              <label>1) Planos generales - Layout de la empresa<span class="required">*</span></label>
              <input type="file" name="planos" accept=".pdf,.jpg,.jpeg,.png,.dwg" required data-file-input="planos">
              <span class="helper-text">‚ö†Ô∏è OBLIGATORIO - Formatos: PDF, JPG, PNG, DWG (M√°x. 10MB)</span>
              <div class="file-preview" data-preview="planos">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="planos">Eliminar</button>
                </div>
              </div>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="mantenimiento">
              <label>2) Programa de mantenimiento</label>
              <input type="file" name="mantenimiento" accept=".pdf,.doc,.docx,.xls,.xlsx" data-file-input="mantenimiento">
              <span class="helper-text">Luminarias, maquinaria, sistema de tierras (seg√∫n aplique)</span>
              <div class="file-preview" data-preview="mantenimiento">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="mantenimiento">Eliminar</button>
                </div>
              </div>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="proceso_produccion">
              <label>3) Proceso de producci√≥n</label>
              <input type="file" name="proceso_produccion" accept=".pdf,.doc,.docx" data-file-input="proceso_produccion">
              <span class="helper-text">Solo si no lo describi√≥ anteriormente</span>
              <div class="file-preview" data-preview="proceso_produccion">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="proceso_produccion">Eliminar</button>
                </div>
              </div>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group full-width file-upload-group" data-upload-group="requisitos_ingreso">
              <label>4) Requisitos obligatorios para ingresar a planta</label>
              <input type="file" name="requisitos_ingreso" accept=".pdf,.doc,.docx" data-file-input="requisitos_ingreso">
              <span class="helper-text">EPP, documentaci√≥n u otros</span>
              <div class="file-preview" data-preview="requisitos_ingreso">
                <div class="file-preview-content">
                  <div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div>
                  <button type="button" class="file-remove" data-clear="requisitos_ingreso">Eliminar</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">NOM-020-STPS - RECIPIENTES, CALDERAS Y GENERADORES DE VAPOR</div>

          <div class="form-grid">
            <div class="form-group full-width">
              <label style="font-size:13px; text-transform:none;">   
                ¬øEl servicio es para evaluaci√≥n de NOM-020-STPS-2011 (Recipientes sujetos a presi√≥n, recipientes criog√©nicos y generadores de vapor o calderas)?<span class="required">*</span>
              </label>
              <div class="radio-group">
                <div class="radio-option">
                  <input type="radio" id="nom020_si" name="aplica_nom020" value="si" required>
                  <label for="nom020_si">S√≠</label>
                </div>
                <div class="radio-option">
                  <input type="radio" id="nom020_no" name="aplica_nom020" value="no">
                  <label for="nom020_no">No, no aplica para nosotros</label>
                </div>
              </div>
            </div>
          </div>

          <div id="documentacionLegalSection" class="conditional-section">
            <div class="conditional-header">‚ö†Ô∏è DOCUMENTACI√ìN OBLIGATORIA PARA NOM-020-STPS</div>
            <div class="form-grid"><div class="form-group full-width file-upload-group" data-upload-group="ine_atencion"><label>A) INE de quien nos atender√°<span class="required">*</span></label><input type="file" name="ine_atencion" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_atencion" data-conditional-required="nom020"><div class="file-preview" data-preview="ine_atencion"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="ine_atencion">Eliminar</button></div></div></div></div>
            <div class="form-grid">
              <div class="form-group"><label>B) Nombre y puesto Testigo 1<span class="required">*</span></label><input type="text" name="testigo1" data-conditional-required="nom020"></div>
              <div class="form-group file-upload-group" data-upload-group="ine_testigo1"><label>INE Testigo 1<span class="required">*</span></label><input type="file" name="ine_testigo1" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_testigo1" data-conditional-required="nom020"><div class="file-preview" data-preview="ine_testigo1"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="ine_testigo1">Eliminar</button></div></div></div>
            </div>
            <div class="form-grid">
              <div class="form-group"><label>C) Nombre y puesto Testigo 2<span class="required">*</span></label><input type="text" name="testigo2" data-conditional-required="nom020"></div>
              <div class="form-group file-upload-group" data-upload-group="ine_testigo2"><label>INE Testigo 2<span class="required">*</span></label><input type="file" name="ine_testigo2" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_testigo2" data-conditional-required="nom020"><div class="file-preview" data-preview="ine_testigo2"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="ine_testigo2">Eliminar</button></div></div></div>
            </div>
            <div class="form-grid"><div class="form-group full-width file-upload-group" data-upload-group="poder_notarial"><label>D) Poder notarial<span class="required">*</span></label><input type="file" name="poder_notarial" accept=".pdf" data-file-input="poder_notarial" data-conditional-required="nom020"><div class="file-preview" data-preview="poder_notarial"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="poder_notarial">Eliminar</button></div></div></div></div>
            <div class="form-grid"><div class="form-group full-width file-upload-group" data-upload-group="ine_representante"><label>E) INE del representante legal<span class="required">*</span></label><input type="file" name="ine_representante" accept=".pdf,.jpg,.jpeg,.png" data-file-input="ine_representante" data-conditional-required="nom020"><div class="file-preview" data-preview="ine_representante"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="ine_representante">Eliminar</button></div></div></div></div>
            <div class="form-grid"><div class="form-group full-width file-upload-group" data-upload-group="situacion_fiscal"><label>F) Constancia de situaci√≥n fiscal<span class="required">*</span></label><input type="file" name="situacion_fiscal" accept=".pdf" data-file-input="situacion_fiscal" data-conditional-required="nom020"><div class="file-preview" data-preview="situacion_fiscal"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="situacion_fiscal">Eliminar</button></div></div></div></div>
            <div class="form-grid"><div class="form-group full-width file-upload-group" data-upload-group="licencia"><label>G) Licencia de uso de suelo<span class="required">*</span></label><input type="file" name="licencia" accept=".pdf" data-file-input="licencia" data-conditional-required="nom020"><div class="file-preview" data-preview="licencia"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="licencia">Eliminar</button></div></div></div></div>
            <div class="form-grid"><div class="form-group full-width file-upload-group" data-upload-group="dc3"><label>H) DC-3 personal operador<span class="required">*</span></label><input type="file" name="dc3" accept=".pdf" data-file-input="dc3" data-conditional-required="nom020"><div class="file-preview" data-preview="dc3"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="dc3">Eliminar</button></div></div></div></div>
            
            <div class="form-grid">
              <div class="form-group full-width file-upload-group" data-upload-group="calibracion_valvula">
                <label>I) Dictamen de Calibraci√≥n de la v√°lvula <span class="required">*</span></label>
                <div style="background: #fff8e1; border: 1px solid #ffe082; padding: 10px; border-radius: 4px; margin-bottom: 10px; display: flex; align-items: flex-start; gap: 8px;">
                  <input type="checkbox" id="check_sin_calibracion" name="sin_calibracion">
                  <label for="check_sin_calibracion" style="font-size: 11px; color: #f57f17; text-transform: none; margin: 0;">
                    <strong>Si no tienes calibradas tus v√°lvulas</strong>, puedes contratar este servicio con Ejecutiva Ambiental.
                  </label>
                </div>
                <input type="file" name="calibracion_valvula" accept=".pdf" data-file-input="calibracion_valvula" data-conditional-required="nom020">
                <div class="file-preview" data-preview="calibracion_valvula"><div class="file-preview-content"><div class="file-info"><span class="file-icon">üìÑ</span><div><div class="file-name"></div><div class="file-size"></div></div></div><button type="button" class="file-remove" data-clear="calibracion_valvula">Eliminar</button></div></div>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">Programa Interno de Protecci√≥n Civil (PIPC)</div>
          <div class="form-grid">
            <div class="form-group full-width">
              <label>¬øEl servicio es para realizar su PIPC?<span class="required">*</span></label>
              <div class="radio-group">
                <div class="radio-option"><input type="radio" id="pipc_si" name="requiere_pipc" value="si" required><label for="pipc_si">S√≠</label></div>
                <div class="radio-option"><input type="radio" id="pipc_no" name="requiere_pipc" value="no"><label for="pipc_no">No</label></div>
              </div>
            </div>
          </div>
          <div id="documentacionPIPCSection" class="conditional-section">
            <div class="conditional-header">üìã DOCUMENTACI√ìN REQUERIDA PARA PIPC</div>
            </div>
        </div>

        <div class="submit-section">
          <button type="submit" class="btn-submit" id="submitBtn">Revisar y Enviar Informaci√≥n</button>
          <div class="loading" id="loading"><div class="loading-spinner"></div><p class="loading-text">üîÑ Subiendo documentos...</p></div>
          <div class="message success-message" id="successMsg"><strong>¬°Informaci√≥n enviada correctamente!</strong></div>
          <div class="message error-message" id="errorMsg">‚úó Error al enviar. Intente nuevamente.</div>
        </div>
      </form>
    </div>
  </div>

  <div class="floating-buttons">
    <a href="tel:2229417295" class="floating-btn phone" title="Llamar ahora">
      <span class="floating-btn-tooltip">¬øDudas con el formulario? Ll√°manos: 222 941 7295</span>üìû
    </a>
    <a href="https://wa.me/522791113533" target="_blank" class="floating-btn whatsapp" title="WhatsApp">
      <span class="floating-btn-tooltip">¬øNecesitas ayuda llenando esto? WhatsApp: 279 111 3533</span>üí¨
    </a>
  </div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz6G0GfCxfh6NmOEHsB-HepHE6kRJKTrUTVURPZY0qTX0M5S17wIjjlbl2Ea-bquc79/exec';
    const MAX_FILE_SIZE = 10 * 1024 * 1024;

    // L√≥gica de cookies y modales bienvenida
    function closeWelcomeModal() { document.getElementById('welcomeModal').style.display = 'none'; }
    
    // L√≥gica de Previews de archivos
    document.querySelectorAll('input[type="file"]').forEach(input => {
      input.addEventListener('change', function() {
        const fileKey = this.dataset.fileInput;
        const preview = document.querySelector(`[data-preview="${fileKey}"]`);
        if (this.files && this.files[0]) {
          preview.querySelector('.file-name').textContent = this.files[0].name;
          preview.classList.add('active');
        }
      });
    });

    // CAMBIO 5: Modal de Confirmaci√≥n actualizado con Sucursal
    function showConfirmationModal() {
      const form = document.getElementById('perfilDatosForm');
      const formData = new FormData(form);
      const confirmationHTML = `
        <div class="confirmation-section">
          <h3>üìã DATOS GENERALES</h3>
          <div class="confirmation-item"><span class="confirmation-label">Raz√≥n Social:</span><span class="confirmation-value">${formData.get('razon_social') || ''}</span></div>
          <div class="confirmation-item"><span class="confirmation-label">Sucursal:</span><span class="confirmation-value">${formData.get('sucursal') || ''}</span></div>
          <div class="confirmation-item"><span class="confirmation-label">RFC:</span><span class="confirmation-value">${formData.get('rfc') || ''}</span></div>
          <div class="confirmation-item"><span class="confirmation-label">Correo:</span><span class="confirmation-value">${formData.get('correo_informe') || ''}</span></div>
        </div>
        <div class="modal-buttons">
          <button type="button" class="btn-modal btn-confirm" onclick="confirmAndSend()">‚úì Enviar</button>
          <button type="button" class="btn-modal btn-cancel" onclick="document.getElementById('confirmationModal').classList.remove('active')">Corregir</button>
        </div>
      `;
      document.getElementById('confirmationContent').innerHTML = confirmationHTML;
      document.getElementById('confirmationModal').classList.add('active');
    }

    formMain = document.getElementById('perfilDatosForm');
    formMain.addEventListener('submit', e => { e.preventDefault(); showConfirmationModal(); });

    async function confirmAndSend() {
      document.getElementById('confirmationModal').classList.remove('active');
      document.getElementById('loading').style.display = 'block';
      // L√≥gica de env√≠o id√©ntica a tu original...
      // [Resto del c√≥digo de env√≠o Base64]
      document.getElementById('loading').style.display = 'none';
      document.getElementById('successMsg').style.display = 'block';
    }
  </script>
</body>
</html>
